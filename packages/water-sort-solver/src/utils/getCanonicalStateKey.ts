// src/utils/getCanonicalStateKey.ts

import { GameState } from '../types';

/**
 * Преобразует состояние игры в каноническую строку-ключ.
 * Эта строка уникальна для любого эквивалентного состояния игры,
 * независимо от порядка пробирок в массиве.
 * @param state - Текущее состояние игры.
 * @returns Уникальный строковый ключ для данного состояния.
 */
export function getCanonicalStateKey(state: GameState): string {
  // 1. Преобразуем каждую пробирку в строку. Например, [1, 2, 2] -> "1,2,2".
  const tubeStrings = state.map(tube => tube.join(','));

  // 2. Сортируем массив этих строк в алфавитном порядке.
  // Это гарантирует, что порядок пробирок не повлияет на финальный ключ.
  tubeStrings.sort();

  // 3. Объединяем все строки в один уникальный ключ через разделитель.
  // ['1,2', '3,4', ''].sort() -> ['', '1,2', '3,4'].join('|') -> "|1,2|3,4"
  return tubeStrings.join('|');
}